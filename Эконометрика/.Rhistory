library(readxl)
library(lmtest)
data <- read_excel("data.xlsx")
data
x = data$x
y = data$y
x
y
#???????? ??????
reg = lm(y~x)
m_s = summary(reg)
m_s_e = m_s$residuals
m_s_se = m_s$sigma
m_s_rsq = m_s$r.squared
a = sum(abs(m_s_e/y))*100/length(y); a
library(readxl)
library(lmtest)
data <- read_excel("data.xlsx")
data
x = data$x
y = data$y
x
y
#???????? ??????
reg = lm(y~x)
m_s = summary(reg)
m_s_e = m_s$residuals
m_s_se = m_s$sigma
m_s_rsq = m_s$r.squared
a = sum(abs(m_s_e/y))*100/length(y); a
#????????????? ??????
Y = log(y)
reg_2 = lm(Y~x)
m_s_2 = summary(reg_2)
m_s_e2 = m_s_2$residuals
m_s_se2 = m_s_2$sigma
m_s_rsq2 = m_s_2$r.squared
a2 = sum(abs(m_s_e2/log(y)))*100/length(y); a2
exp(summary(reg_2)$coefficient[1,1]) #? ?????
exp(summary(reg_2)$coefficient[2,1])
Y = log(y)
X = log(x)
reg_3 = lm(Y~X)
m_s_3 = summary(reg_3);m_s_3
m_s_e3 = m_s_3$residuals;m_s_e3
m_s_se3 = m_s_3$sigma;m_s_se3
m_s_rsq3 = m_s_3$r.squared;m_s_rsq3
a3 = sum(abs(m_s_e3/log(y)))*100/length(y); a3
X2 = 1/x
reg_4 = lm(y~X2)
m_s_4  = summary(reg_4);m_s_4
m_s_e4 = m_s_4$residuals;m_s_e4
m_s_se4  = m_s_4$sigma;m_s_se4
m_s_rsq4 = m_s_4$r.squared;m_s_rsq4
a4 = sum(abs(m_s_e4/y))*100/length(y); a4
df = data.frame(c(m_s_se,exp(m_s_se2),exp(m_s_se3),m_s_se4),
c(m_s_rsq,m_s_rsq2,m_s_rsq3,m_s_rsq4), c(a,a2,a3,a4),
row.names = c('????????', "?????????????", "?????????", "???????????????"))
show(df)
colnames(df) = c('sigma','r-squared', 'Approximation error'); df
m_s_2
View(df)
View(df)
Y
m_s = summary(reg)
m_s
library(lmtest)
library(orcutt)
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21222020.xlsx", header = TRUE, dec=',')
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.xlsx", header = TRUE, dec=',')
source('C:/Users/User/Desktop/Эконометрика/sem11.R', encoding = 'UTF-8', echo=TRUE)
source('C:/Users/User/Desktop/Эконометрика/sem11.R', encoding = 'UTF-8', echo=TRUE)
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=',')
df
df <- read.table(file = "data21112020.csv", header = TRUE, dec=';')
df
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=';')
df
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=';')
df <- read.table(file = "data21112020.csv", header = TRUE, dec=';')
df
df.year
df$year
df <- read.table(file = "data21112020.csv", header = TRUE, dec=',')
df$year
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=',')
df
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=c(',', ';'))
df
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec='.')
df
library(lmtest)
library(orcutt)
#Никитин Роман ПИ18-2
#1 task
df <- read.table(file = "data21112020.csv", header = TRUE, dec=',')
df
df <- read.table(file = "data21112020.csv", header = TRUE, dec=',')
df
df <- read.table(file = "data21112020.csv", header = TRUE, dec=';')
df
df <- read.csv2(file = "data21112020.csv", header = TRUE, dec=';')
df
df <- read.csv2(file = "data21112020.csv", header = TRUE, dec=',')
df
vvp = df$VVP
vvp = df$VVP
scn = df.SCN
df <- read.csv2(file = "data21112020.csv", header = TRUE, dec=',')
vvp = df$VVP
scn = df$SCN
gpn = df$GPN
odn = df$ODN
lm1 <- lm(vvp ~ 0 + scn + gpn + odn)
s1 <- summary(lm1); s1
gpn
s1 <- summary(lm1); s1
gpn
df
df <- read.csv2(file = "data21112020.csv", header = TRUE, dec=',')
vvp = df$VVP
scn = df$SCN
gpn = df$GPN
odn = df$ODN
Y = log(gdp)
gpn
head(df)
lm1 <- lm(vvp ~ 0 + scn + gpn + odn)
s1 <- summary(lm1); s1
coch = cochrane.orcutt(lm1); coch
sum_coch = summary(coch); sum_coch
lm1_dw = dwtest(lm1); lm1_dw
#Есть автокорреляция первого порядка
lm1_coch_dw = dwtest(coch); lm1_coch_dw
#Нет автокорреляции первого порядка
lm1_bg = bgtest(lm1, order = 1); lm1_bg
#Есть автокорреляция первого порядка
lm1_coch_bg = bgtest(coch, order = 1); lm1_coch_bg
#Нет автокорреляции первого порядка
lm1_bg_o2 = bgtest(lm1, order = 2); lm1_bg_o2
#Есть автокорреляция второго порядка
lm1_coch_bg_o2 = bgtest(coch, order = 2); lm1_coch_bg_o2
#Нет автокорреляции второго порядка
#2 task
df_2 = read.table(file = "task2.txt", header = TRUE, dec=',')
df_2
lm2 = lm(as.numeric(df_2$Turist) ~ as.numeric(df_2$Reclama));lm2
coch2 = cochrane.orcutt(lm2); coch2
s2 <- summary(lm2); s2
#F-statistic: 282.3 on 1 and 54 DF,  p-value: < 2.2e-16
#Модель значима.
#Коэффициент Х значим.
#Свободный коэффициент не значим.
confint(lm2, level=0.9)
lm2_dw = dwtest(lm2); lm2_dw
#Нет автокорреляции первого порядка
lm2_coch_dw = dwtest(coch2); lm2_coch_dw
#Нет автокорреляции первого порядка
lm2_bg = bgtest(lm2, order = 1); lm2_bg
#Нет автокорреляции первого порядка
lm2_coch_bg = bgtest(coch2, order = 1); lm2_coch_bg
#Есть автокорреляция первого порядка
lm2_bg_o2 = bgtest(lm1, order = 2); lm2_bg_o2
#Есть автокорреляция второго порядка
lm2_coch_bg_o2 = bgtest(coch2, order = 2); lm2_coch_bg_o2
#Есть автокорреляция второго порядка
#ѕроверка на гетероскедастичность
lm2_gq <- gqtest(lm2, fraction = 0.25); lm2_gq;
#√етероскедастичности нет (при альфа = 0.1)
lm2_bp <- bptest(lm2, varformula = ~as.numeric(df_2$Reclama) + I(as.numeric(df_2$Reclama)^2)); lm2_bp;
#√етероскедастичности нет (при альфа = 0.1)
#3 task
df3 <- read.table('task3.txt', header=TRUE)
head(df3)
df3_X <- df3$Площадь
df3_Y <- df3$Цена
df3_m <- lm(df3_Y ~ df3_X)
df3_s <- summary(df3_m); df3_s
#Модель значима (при альфа = 0.01)
#Коэффициент при X значим (при альфа = 0.01)
#Коэффициент при константе незначим (при альфа = 0.1)
df3_confint <- confint(df3_m, level=0.95); df3_confint
#Проверка на гетероскедастичность
df3_gq <- gqtest(df3_m, fraction = 0.25); df3_gq;
#Гетероскедастичности нет (при альфа = 0.1) - p-value = 1 Ўќ !
df3_bp <- bptest(df3_m, varformula = ~df3_X + I(df3_X^2)); df3_bp;
#Гетероскедастичность есть (при альфа = 0.1)
#Проверка на автокорреляцию
df3_dw <- dwtest(df3_m); df3_dw
#Автокорреляции нет (при альфа = 0.1)
df3_bg <- bgtest(df3_m, order=1); df3_bg;
#Автокорреляции первого порядка нет (при альфа = 0.1)
df3_bg2 <- bgtest(df3_m, order=2); df3_bg2;
#Автокорреляции второго порядка нет (при альфа = 0.1)
#Устранить гетероскедастичность
df3_fitted <- df3_m$fitted.values
df3_X_ed <- df3_X/df3_fitted
df3_Y_ed <- df3_Y/df3_fitted
df3_const_ed <- 1/df3_fitted
df3_m_ed <- lm(df3_Y_ed ~ 0 + df3_const_ed + df3_X_ed)
df3_s_ed <- summary(df3_m_ed); df3_s_ed
#Проверка на гетероскедастичность
df3_ed_gq <- gqtest(df3_m_ed, fraction = 0.25); df3_ed_gq;
#Гетероскедастичности нет (при альфа = 0.1)
df3_ed_bp <- bptest(df3_m_ed, varformula = ~df3_X_ed + I(df3_X_ed^2)); df3_ed_bp;
#Гетероскедастичности нет (при альфа = 0.1)
lm1_dw = dwtest(lm1); lm1_dw
lm1_coch_dw = dwtest(coch); lm1_coch_dw
lm1_coch_dw = dwtest(coch); lm1_coch_dw
lm1_bg = bgtest(lm1, order = 1); lm1_bg
lm1_coch_bg = bgtest(coch, order = 1); lm1_coch_bg
lm1_bg_o2 = bgtest(lm1, order = 2); lm1_bg_o2
lm1_coch_bg_o2 = bgtest(coch, order = 2); lm1_coch_bg_o2
#ѕроверка на гетероскедастичность
lm1_gq <- gqtest(lm1); lm1_gq;
#Гетероскедастичности есть (при альфа = 0.01)
lm1_bp <- bptest(lm1); lm1_bp;
#Гетероскедастичности есть (при альфа = 0.01)
lm1_bp <- bptest(lm1); lm1_bp;
#Гетероскедастичности есть (при альфа = 0.01)
lm1_bp <- bptest(lm1); lm1_bp;
#ѕроверка на гетероскедастичность
lm1_gq <- gqtest(lm1); lm1_gq;
#Гетероскедастичности есть (при альфа = 0.01)
lm1_bp <- bptest(lm1); lm1_bp;
confint(lm1, level=0.95)
lm1_2 = confint(lm1, level=0.95)
lm2_dw = dwtest(lm1_2); lm2_dw
sum_coch = summary(coch); sum_coch
lm2_dw = dwtest(lm1_2); lm2_dw
#ѕроверка на гетероскедастичность
lm1_gq <- gqtest(lm1); lm1_gq;
#Гетероскедастичность есть (при альфа = 0.01)
lm1_bp <- bptest(lm1); lm1_bp;
lm1_dw = dwtest(lm1); lm1_dw
lm1_coch_dw = dwtest(coch); lm1_coch_dw
library(lmtest)
library(orcutt)
#Никитин Роман ПИ18-2
df <- read.csv2(file = "data21112020.csv", header = TRUE, dec=',')
vvp = df$VVP
scn = df$SCN
gpn = df$GPN
odn = df$ODN
Y = log(gdp)
head(df)
df
lm1 <- lm(vvp ~ odn + scn + gpn)
s1 <- summary(lm1); s1
# scn не значим для качества модели (не приносит в нее значительных изменений.)
# gpn и odn значимы на уровне значимости 0.01
# Модель значима
#ѕроверка на гетероскедастичность
lm1_gq <- gqtest(lm1); lm1_gq;
#Гетероскедастичности нет (при альфа = 0.1)
lm1_bp <- bptest(lm1); lm1_bp;
#Гетероскедастичность есть (при альфа = 0.05)
fitted = lm1$fitted.values
qqplot(fitted, vvp)
#Гетероскедастичность есть, пятипроцентненькая)
lm1_2 = confint(lm1, level=0.95)
coch = cochrane.orcutt(lm1); coch
sum_coch = summary(coch); sum_coch
lm1_dw = dwtest(lm1); lm1_dw
#Есть автокорреляция первого порядка
lm1_coch_dw = dwtest(coch); lm1_coch_dw
#Нет автокорреляции первого порядка
lm1_bg = bgtest(lm1, order = 1); lm1_bg
#Есть автокорреляция первого порядка
lm1_coch_bg = bgtest(coch, order = 1); lm1_coch_bg
#Нет автокорреляции первого порядка
lm1_bg_o2 = bgtest(lm1, order = 2); lm1_bg_o2
#Есть автокорреляция второго порядка
lm1_coch_bg_o2 = bgtest(coch, order = 2); lm1_coch_bg_o2
#Есть автокорреляция второго порядка на увроне значимости 0.1
lm1_bg_o3 = bgtest(lm1, order = 3); lm1_bg_o3
#Есть автокорреляция второго порядка
lm1_coch_bg_o3 = bgtest(coch, order = 3); lm1_coch_bg_o3
#Есть автокорреляция второго порядка на увроне значимости 0.1
new_year <- df[24,]
new_year$ODN <- new_year$ODN * 0.91
new_year$SCN <- 44.46
new_year$GPN <- 92
new_year
answ = predict(lm1, new_year)[24]
answ
